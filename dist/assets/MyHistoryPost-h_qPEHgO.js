import{u as L,r as c,o as F,l as P,h as o,k as M,g as s,j as u,aT as O,x as p,A as v,w as l,m as q,M as G,a1 as K,f as z,p as Q,aJ as W,au as X,a4 as Y,aU as Z,ay as ee,a3 as te,E as _,a as ae,c as oe,at as se,J as f}from"./index-GmfRbgMx.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{_ as ne}from"./_plugin-vue_export-helper-DedD7E0N.js";/* empty css                  */import{f as S}from"./format-BoKD-3ja.js";import{n as le}from"./router-nVzJmOxy.js";import{j as ie,h as re}from"./forum-D70lqkAe.js";/* empty css                       *//* empty css                   */const ce={class:"my-posts-container"},ue={class:"posts-header"},pe={key:0,class:"user-info"},de={class:"username"},me={class:"user-stats"},_e={class:"stat-item"},ge={class:"posts-content"},ve=["onClick"],fe={class:"post-stats"},he={class:"post-actions"},ye={class:"pagination-container"},we={__name:"MyHistoryPost",setup(Ce){const b=ae(),i=L(),B=c({});B.value=i.userinfo||{};const d=c(1),h=c(10),y=c(0),w=c([]),C=c(!1),g=async()=>{var e;if(!((e=i.userinfo)!=null&&e.id)){_.warning("请先登录"),b.push("/login");return}C.value=!0;try{const t={userId:i.userinfo.id,page:d.value,pageSize:h.value},r=await ie(t);r.data.code===0?(w.value=r.data.data.list||[],y.value=r.data.data.total||0,w.value.forEach(n=>{n.publishTime&&(n.publishTime=S(n.publishTime)),n.lastReply&&(n.lastReply=S(n.lastReply))})):_.error(r.data.msg||"获取发帖记录失败")}catch(t){console.error("获取用户发帖记录失败",t),_.error("获取发帖记录失败")}finally{C.value=!1}},T=e=>{le(`/post/${e}`)},A=e=>{oe.confirm(`确定要删除帖子"${e.title}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await re(e.id),_.success("帖子删除成功"),g()}catch(t){console.error("删除帖子失败",t),_.error("删除帖子失败")}}).catch(()=>{})},V=e=>{d.value=e,g()},I=e=>{h.value=e,d.value=1,g()},N=()=>{b.push("/publish-post")},U=e=>({team:"打球组队",notice:"赛事讨论",help:"求助问答",exp:"经验交流"})[e]||"其他",$=e=>({team:"success",notice:"primary",help:"warning",exp:"info"})[e]||"default";return F(()=>{g()}),(e,t)=>{var k,x;const r=O,n=q,D=Q,m=X,R=Y,j=se,H=te,J=K;return f(),P("div",ce,[t[3]||(t[3]=o("h2",null,"我的发帖",-1)),o("div",ue,[u(i).token?(f(),P("div",pe,[s(r,{src:((k=u(i).userinfo)==null?void 0:k.avatar)||"https://tse1-mm.cn.bing.net/th/id/OIP-C.gaAkkFf8LStn-oc4l8iM0wAAAA?w=160&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7"},null,8,["src"]),o("span",de,p(((x=u(i).userinfo)==null?void 0:x.username)||"羽球爱好者"),1),o("div",me,[o("div",_e,[t[1]||(t[1]=v("发帖数量：")),o("span",null,p(y.value),1)])])])):M("",!0),s(n,{type:"primary",onClick:N},{default:l(()=>t[2]||(t[2]=[v("发布新帖")])),_:1})]),o("div",ge,[G((f(),z(j,{data:w.value,style:{width:"100%"},"empty-text":"暂无发帖记录"},{default:l(()=>[s(m,{prop:"title",label:"帖子标题","min-width":"300"},{default:l(a=>[o("div",{class:"post-title",onClick:E=>T(a.row.id)},[a.row.isTop?(f(),z(D,{key:0,class:"top-icon"},{default:l(()=>[s(u(W))]),_:1})):M("",!0),v(" "+p(a.row.title),1)],8,ve)]),_:1}),s(m,{prop:"categoryCode",label:"分类",width:"120"},{default:l(a=>[s(R,{type:$(a.row.categoryCode)},{default:l(()=>[v(p(U(a.row.categoryCode)),1)]),_:2},1032,["type"])]),_:1}),s(m,{prop:"publishTime",label:"发布时间",width:"180"}),s(m,{label:"回复/查看",width:"120"},{default:l(a=>[o("div",fe,[o("div",null,p(a.row.replyCount||0)+" 回复",1),o("div",null,p(a.row.views||0)+" 查看",1)])]),_:1}),s(m,{label:"操作",width:"150"},{default:l(a=>[o("div",he,[s(n,{type:"primary",icon:u(Z),circle:"",size:"small",onClick:E=>T(a.row.id),title:"查看详情"},null,8,["icon","onClick"]),s(n,{type:"danger",icon:u(ee),circle:"",size:"small",onClick:E=>A(a.row),title:"删除帖子"},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])),[[J,C.value]]),o("div",ye,[s(H,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),"page-size":h.value,total:y.value,"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:I,onCurrentChange:V},null,8,["modelValue","page-size","total"])])])])}}},Re=ne(we,[["__scopeId","data-v-e99091bf"]]);export{Re as default};
