import{u as L,r as c,o as q,q as P,l as o,p as M,j as s,n as u,aT as O,B as p,F as g,w as l,s as G,M as J,a1 as K,f as z,a3 as Q,E as _,b as W,at as X,i as f,au as Y,v as Z,aI as ee,a4 as te,aV as ae,ay as oe,c as se}from"./index-Ba57xZaz.js";/* empty css                   *//* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";import{_ as ne}from"./_plugin-vue_export-helper-DedD7E0N.js";/* empty css                  */import{f as B}from"./format-BoKD-3ja.js";import{n as le}from"./router-Dmq0MUEd.js";import{j as ie,h as re}from"./forum-D6rTVyAt.js";/* empty css                       *//* empty css                   */const ce={class:"my-posts-container"},ue={class:"posts-header"},pe={key:0,class:"user-info"},de={class:"username"},me={class:"user-stats"},_e={class:"stat-item"},ve={class:"posts-content"},ge=["onClick"],fe={class:"post-stats"},ye={class:"post-actions"},he={class:"pagination-container"},we={__name:"MyHistoryPost",setup(Ce){const b=W(),i=L(),S=c({});S.value=i.userinfo||{};const d=c(1),y=c(10),h=c(0),w=c([]),C=c(!1),v=async()=>{var e;if(!((e=i.userinfo)!=null&&e.id)){_.warning("请先登录"),b.push("/login");return}C.value=!0;try{const t={userId:i.userinfo.id,page:d.value,pageSize:y.value},r=await ie(t);r.data.code===0?(w.value=r.data.data.list||[],h.value=r.data.data.total||0,w.value.forEach(n=>{n.publishTime&&(n.publishTime=B(n.publishTime)),n.lastReply&&(n.lastReply=B(n.lastReply))})):_.error(r.data.msg||"获取发帖记录失败")}catch(t){console.error("获取用户发帖记录失败",t),_.error("获取发帖记录失败")}finally{C.value=!1}},T=e=>{le(`/post/${e}`)},V=e=>{se.confirm(`确定要删除帖子"${e.title}"吗？`,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await re(e.id),_.success("帖子删除成功"),v()}catch(t){console.error("删除帖子失败",t),_.error("删除帖子失败")}}).catch(()=>{})},A=e=>{d.value=e,v()},I=e=>{y.value=e,d.value=1,v()},N=()=>{b.push("/publish-post")},$=e=>({team:"打球组队",notice:"赛事讨论",help:"求助问答",exp:"经验交流"})[e]||"其他",D=e=>({team:"success",notice:"primary",help:"warning",exp:"info"})[e]||"default";return q(()=>{v()}),(e,t)=>{var k,x;const r=O,n=G,R=Z,m=Y,U=te,j=X,F=Q,H=K;return f(),P("div",ce,[t[3]||(t[3]=o("h2",null,"我的发帖",-1)),o("div",ue,[u(i).token?(f(),P("div",pe,[s(r,{src:((k=u(i).userinfo)==null?void 0:k.avatar)||"https://tse1-mm.cn.bing.net/th/id/OIP-C.gaAkkFf8LStn-oc4l8iM0wAAAA?w=160&h=180&c=7&r=0&o=5&dpr=1.5&pid=1.7"},null,8,["src"]),o("span",de,p(((x=u(i).userinfo)==null?void 0:x.username)||"羽球爱好者"),1),o("div",me,[o("div",_e,[t[1]||(t[1]=g("发帖数量：")),o("span",null,p(h.value),1)])])])):M("",!0),s(n,{type:"primary",onClick:N},{default:l(()=>t[2]||(t[2]=[g("发布新帖")])),_:1})]),o("div",ve,[J((f(),z(j,{data:w.value,style:{width:"100%"},"empty-text":"暂无发帖记录"},{default:l(()=>[s(m,{prop:"title",label:"帖子标题","min-width":"300"},{default:l(a=>[o("div",{class:"post-title",onClick:E=>T(a.row.id)},[a.row.isTop?(f(),z(R,{key:0,class:"top-icon"},{default:l(()=>[s(u(ee))]),_:1})):M("",!0),g(" "+p(a.row.title),1)],8,ge)]),_:1}),s(m,{prop:"categoryCode",label:"分类",width:"120"},{default:l(a=>[s(U,{type:D(a.row.categoryCode)},{default:l(()=>[g(p($(a.row.categoryCode)),1)]),_:2},1032,["type"])]),_:1}),s(m,{prop:"publishTime",label:"发布时间",width:"180"}),s(m,{label:"回复/查看",width:"120"},{default:l(a=>[o("div",fe,[o("div",null,p(a.row.replyCount||0)+" 回复",1),o("div",null,p(a.row.views||0)+" 查看",1)])]),_:1}),s(m,{label:"操作",width:"150"},{default:l(a=>[o("div",ye,[s(n,{type:"primary",icon:u(ae),circle:"",size:"small",onClick:E=>T(a.row.id),title:"查看详情"},null,8,["icon","onClick"]),s(n,{type:"danger",icon:u(oe),circle:"",size:"small",onClick:E=>V(a.row),title:"删除帖子"},null,8,["icon","onClick"])])]),_:1})]),_:1},8,["data"])),[[H,C.value]]),o("div",he,[s(F,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=a=>d.value=a),"page-size":y.value,total:h.value,"page-sizes":[5,10,20,50],layout:"total, sizes, prev, pager, next",onSizeChange:I,onCurrentChange:A},null,8,["modelValue","page-size","total"])])])])}}},Ue=ne(we,[["__scopeId","data-v-e99091bf"]]);export{Ue as default};
