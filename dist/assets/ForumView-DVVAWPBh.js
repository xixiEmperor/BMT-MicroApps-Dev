import{aI as M,u as $,r as u,o as j,L as C,l as V,h as l,g as s,w as n,m as A,af as K,ap as Q,j as k,at as q,a3 as G,J as f,A as T,P as H,Q as O,f as E,as as W,au as X,k as Y,p as Z,aJ as ee,x as m,E as te}from"./index-GmfRbgMx.js";/* empty css                      *//* empty css               *//* empty css                  *//* empty css                     *//* empty css                 *//* empty css                        *//* empty css                    */import"./el-tooltip-l0sNRNKZ.js";/* empty css                    */import{_ as ae}from"./_plugin-vue_export-helper-DedD7E0N.js";import{n as h}from"./router-nVzJmOxy.js";import{g as oe}from"./forum-D70lqkAe.js";import{u as le}from"./forum-C29PebQP.js";import{f as S}from"./format-BoKD-3ja.js";const se={class:"forum-container"},ne={class:"forum-actions"},ie={class:"forum-content"},re={class:"topics-container"},ue=["onClick"],pe={class:"topic-author"},me={class:"topic-stats"},ce={class:"topic-last-reply"},de={class:"pagination-container"},_e=M({__name:"ForumView",setup(fe){const x=$(),w=le(),z=u([{name:"all",label:"全部帖子"},{name:"team",label:"打球组队"},{name:"notice",label:"赛事讨论"},{name:"help",label:"求助问答"},{name:"exp",label:"经验交流"}]),c=u("all"),d=u("");let v=null;const r=u(1),g=u(5),b=u(0),p=async()=>{const a=await oe({page:r.value,pageSize:g.value,keyword:d.value,category:c.value});if(a.data.code===0){console.log(a);const t=a.data.data.list.map(o=>({...o,publishTime:S(o.publishTime),lastReply:S(o.lastReply)}));t.sort((o,i)=>o.isTop&&!i.isTop?-1:!o.isTop&&i.isTop?1:o.isTop&&i.isTop?new Date(i.topTime||i.publishTime).getTime()-new Date(o.topTime||o.publishTime).getTime():new Date(i.publishTime).getTime()-new Date(o.publishTime).getTime()),w.setPosts(t),b.value=a.data.data.total}};j(async()=>{await p()});const D=()=>{if(!x.token){te.warning("请先登录后再发布文章"),h("/login");return}h("/publish-post")},P=a=>{h(`/post/${a}`)},y=()=>{v&&clearTimeout(v),v=setTimeout(()=>{r.value=1,p()},500)},F=a=>{r.value=a,p()},B=a=>{g.value=a,r.value=1,p()};C(c,()=>{r.value=1,p()}),C(d,()=>{y()});const L=({row:a})=>a.isTop?"top-row":"";return(a,t)=>{const o=A,i=K,N=W,R=Q,I=Z,_=X,U=q,J=G;return f(),V("div",se,[t[5]||(t[5]=l("h2",null,"羽你同行论坛",-1)),l("div",ne,[s(o,{type:"primary",onClick:D},{default:n(()=>t[3]||(t[3]=[T("发布新帖")])),_:1}),s(i,{modelValue:d.value,"onUpdate:modelValue":t[0]||(t[0]=e=>d.value=e),placeholder:"搜索论坛内容",class:"search-input"},{append:n(()=>[s(o,{onClick:y},{default:n(()=>t[4]||(t[4]=[T("搜索")])),_:1})]),_:1},8,["modelValue"])]),l("div",ie,[s(R,{modelValue:c.value,"onUpdate:modelValue":t[1]||(t[1]=e=>c.value=e),class:"demo-tabs"},{default:n(()=>[(f(!0),V(H,null,O(z.value,e=>(f(),E(N,{key:e.name,label:e.label,name:e.name},null,8,["label","name"]))),128))]),_:1},8,["modelValue"]),l("div",re,[s(U,{data:k(w).posts,style:{width:"100%"},"row-class-name":L},{default:n(()=>[s(_,{prop:"title",label:"主题","min-width":"300"},{default:n(e=>[l("div",{class:"topic-title",onClick:ve=>P(e.row.id)},[e.row.isTop?(f(),E(I,{key:0,class:"top-icon"},{default:n(()=>[s(k(ee))]),_:1})):Y("",!0),T(" "+m(e.row.title),1)],8,ue)]),_:1}),s(_,{prop:"author",label:"作者",width:"120"},{default:n(e=>[l("div",pe,m(e.row.author),1)]),_:1}),s(_,{prop:"replies",label:"回复/查看",width:"120"},{default:n(e=>[l("div",me,[l("div",null,m(e.row.replyCount||0)+" 回复",1),l("div",null,m(e.row.views)+" 查看",1)])]),_:1}),s(_,{prop:"lastReply",label:"最后回复",width:"120"},{default:n(e=>[l("div",ce,m(e.row.lastReply),1)]),_:1})]),_:1},8,["data"])]),l("div",de,[s(J,{modelValue:r.value,"onUpdate:modelValue":t[2]||(t[2]=e=>r.value=e),"page-size":g.value,total:b.value,"page-sizes":[5,8,10,15],layout:"total, sizes, prev, pager, next",onSizeChange:B,onCurrentChange:F},null,8,["modelValue","page-size","total"])])])])}}}),Fe=ae(_e,[["__scopeId","data-v-1f7897ed"]]);export{Fe as default};
