# TaskQueue å‡½æ•°è°ƒç”¨å…³ç³»å›¾

## ğŸ“‹ ç³»ç»Ÿæ¦‚è¿°

TaskQueueæ˜¯ä¸€ä¸ªé«˜å¹¶å‘ä»»åŠ¡é˜Ÿåˆ—ç®¡ç†å™¨ï¼Œç”¨äºè§£å†³å¤§é‡å¼‚æ­¥ä»»åŠ¡çš„è°ƒåº¦å’Œç®¡ç†é—®é¢˜ã€‚æœ¬æ–‡æ¡£è¯¦ç»†å±•ç¤ºäº†ç³»ç»Ÿçš„å‡½æ•°è°ƒç”¨å…³ç³»å’Œæ‰§è¡Œæµç¨‹ã€‚

## ğŸ—ï¸ ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                           TaskQueue ç³»ç»Ÿæ¶æ„                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ”„ è¯¦ç»†è°ƒç”¨å…³ç³»å›¾

### 1. åˆå§‹åŒ–é˜¶æ®µ

```
ğŸ—ï¸ åˆå§‹åŒ–é˜¶æ®µï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  new TaskQueue  â”‚
â”‚   (constructor) â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚ åˆå§‹åŒ–é…ç½®    â”‚
    â”‚ åˆå§‹åŒ–çŠ¶æ€    â”‚
    â”‚ åˆå§‹åŒ–ç»Ÿè®¡    â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. ä»»åŠ¡æ·»åŠ é˜¶æ®µ

```
ğŸ“ ä»»åŠ¡æ·»åŠ é˜¶æ®µï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  addTask()  â”‚â”€â”€â”€â”€â”€â–¶â”‚ åˆ›å»ºä»»åŠ¡å¯¹è±¡  â”‚â”€â”€â”€â”€â”€â–¶â”‚ ä¼˜å…ˆçº§æ’åº      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                     â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚ addTasks()  â”‚â”€â”€â”€â”€â”€â–¶â”‚ å¾ªç¯è°ƒç”¨     â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ addTask()    â”‚
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚ updateProgress() â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. é˜Ÿåˆ—æ‰§è¡Œé˜¶æ®µ

```
ğŸš€ é˜Ÿåˆ—æ‰§è¡Œé˜¶æ®µï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   start()   â”‚â”€â”€â”€â”€â”€â–¶â”‚ çŠ¶æ€æ£€æŸ¥     â”‚â”€â”€â”€â”€â”€â–¶â”‚ processQueue()  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ åˆå§‹åŒ–æ—¶é—´    â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                                                     â”‚
                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
                     â”‚ Promiseè½®è¯¢   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                     â”‚ checkComplete â”‚
                     â””â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  isComplete()   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. æ ¸å¿ƒè°ƒåº¦å¾ªç¯

```
ğŸ”„ æ ¸å¿ƒè°ƒåº¦å¾ªç¯ï¼š
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â”Œâ”€â”€â”€â”€â”€â”€â–¶â”‚ processQueue()  â”‚â—€â”€â”€â”€â”€â”€â”€â”
           â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
           â”‚                 â”‚               â”‚
           â”‚                 â–¼               â”‚
           â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
           â”‚       â”‚ å¹¶å‘æ§åˆ¶æ£€æŸ¥     â”‚       â”‚
           â”‚       â”‚ whileå¾ªç¯       â”‚       â”‚
           â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
           â”‚                 â”‚               â”‚
           â”‚                 â–¼               â”‚
           â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
           â”‚       â”‚ tasks.shift()   â”‚       â”‚
           â”‚       â”‚ å–å‡ºä»»åŠ¡        â”‚       â”‚
           â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
           â”‚                 â”‚               â”‚
           â”‚                 â–¼               â”‚
           â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
           â”‚       â”‚ executeTask()   â”‚       â”‚
           â”‚       â”‚ (å¼‚æ­¥æ‰§è¡Œ)      â”‚       â”‚
           â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
           â”‚                 â”‚               â”‚
           â”‚                 â–¼               â”‚
           â”‚       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
           â”‚       â”‚ setTimeout()    â”‚â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚       â”‚ å®šæ—¶å™¨è°ƒåº¦      â”‚
           â”‚       â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â”‚
           â”‚ ğŸ”§ æ§åˆ¶æ“ä½œï¼š
           â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
           â””â”€â”‚   pause()   â”‚    â”‚  resume()   â”‚    â”‚   stop()    â”‚
             â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                          â”‚
                                          â–¼
                                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                â”‚ processQueue()  â”‚
                                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5. ä»»åŠ¡æ‰§è¡Œæµç¨‹

```
âš¡ ä»»åŠ¡æ‰§è¡Œæµç¨‹ï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ executeTask()   â”‚â”€â”€â”€â”€â”€â–¶â”‚ çŠ¶æ€è®¾ç½®         â”‚â”€â”€â”€â”€â”€â–¶â”‚ AbortController â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ executing        â”‚      â”‚ åˆ›å»ºå–æ¶ˆæ§åˆ¶     â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
                         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
                         â”‚ Promise.race()   â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚ è¶…æ—¶æ§åˆ¶         â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚              â”‚              â”‚
                    â–¼              â–¼              â–¼
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ task.fn()       â”‚ â”‚ è¶…æ—¶Promise â”‚ â”‚ å–æ¶ˆä¿¡å·        â”‚
          â”‚ ä¸šåŠ¡é€»è¾‘æ‰§è¡Œ     â”‚ â”‚ timeout     â”‚ â”‚ AbortSignal     â”‚
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚                  â”‚
          â–¼                  â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ æˆåŠŸå¤„ç†        â”‚  â”‚ handleTaskError() â”‚
â”‚ - æ›´æ–°çŠ¶æ€      â”‚  â”‚ é”™è¯¯å¤„ç†         â”‚
â”‚ - è®°å½•ç»“æœ      â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚ - è§¦å‘å›è°ƒ      â”‚            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
          â”‚                    â–¼
          â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚          â”‚ é‡è¯•åˆ¤æ–­        â”‚
          â”‚          â”‚ retries < max   â”‚
          â”‚          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                    â”‚
          â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚          â”‚                  â”‚
          â”‚          â–¼                  â–¼
          â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
          â”‚ â”‚ é‡è¯•å¤„ç†        â”‚  â”‚ æœ€ç»ˆå¤±è´¥        â”‚
          â”‚ â”‚ - å»¶è¿Ÿç­‰å¾…      â”‚  â”‚ - æ ‡è®°å¤±è´¥      â”‚
          â”‚ â”‚ - é‡æ–°å…¥é˜Ÿ      â”‚  â”‚ - è§¦å‘é”™è¯¯å›è°ƒ   â”‚
          â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ finallyå—       â”‚
â”‚ - æ¸…ç†æ‰§è¡ŒçŠ¶æ€   â”‚
â”‚ - updateProgress â”‚
â”‚ - è¯·æ±‚é—´éš”      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6. çŠ¶æ€ç›‘æ§ç³»ç»Ÿ

```
ğŸ“Š çŠ¶æ€ç›‘æ§ç³»ç»Ÿï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ updateProgress()â”‚â”€â”€â”€â”€â”€â–¶â”‚ è®¡ç®—è¿›åº¦ä¿¡æ¯     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ - ç™¾åˆ†æ¯”         â”‚
          â–²               â”‚ - å„çŠ¶æ€æ•°é‡     â”‚
          â”‚               â”‚ - æ‰§è¡Œæ—¶é—´       â”‚
          â”‚               â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚                          â”‚
          â”‚               â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”
          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚ onProgress()     â”‚
                          â”‚ è§¦å‘è¿›åº¦å›è°ƒ     â”‚
                          â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ getResults()    â”‚â”€â”€â”€â”€â”€â–¶â”‚ è¿”å›æ‰§è¡Œç»“æœ     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ - ç»Ÿè®¡ä¿¡æ¯       â”‚
                         â”‚ - æˆåŠŸä»»åŠ¡åˆ—è¡¨   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”‚ - å¤±è´¥ä»»åŠ¡åˆ—è¡¨   â”‚
â”‚ getStatus()     â”‚â”€â”€â”€â”€â”€â–¶â”‚ - æˆåŠŸç‡è®¡ç®—     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 7. å¤±è´¥æ¢å¤ç³»ç»Ÿ

```
ğŸ”„ å¤±è´¥æ¢å¤ç³»ç»Ÿï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚retryFailedTasks()â”‚â”€â”€â”€â”€â”€â–¶â”‚ å¤åˆ¶å¤±è´¥ä»»åŠ¡     â”‚â”€â”€â”€â”€â”€â–¶â”‚ é‡ç½®ä»»åŠ¡çŠ¶æ€    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ æ¸…ç©ºå¤±è´¥è®°å½•     â”‚      â”‚ é‡æ–°å…¥é˜Ÿ        â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
                                                             â”‚
                                                             â–¼
                                                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                                   â”‚ updateProgress() â”‚
                                                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 8. èµ„æºæ¸…ç†ç³»ç»Ÿ

```
ğŸ§¹ èµ„æºæ¸…ç†ç³»ç»Ÿï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   destroy()     â”‚â”€â”€â”€â”€â”€â–¶â”‚ stop()           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                   â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚   clear()       â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”˜
          â”‚
          â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ resetStats()    â”‚â”€â”€â”€â”€â”€â–¶â”‚ æ¸…ç†å®šæ—¶å™¨       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ clearTimeout()   â”‚
                         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 9. å·¥å‚å‡½æ•°ç³»ç»Ÿ

```
ğŸ­ å·¥å‚å‡½æ•°ç³»ç»Ÿï¼š
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚createSpecificationTaskQueue()â”‚â”€â”€â”€â”€â”€â–¶â”‚ é¢„è®¾é…ç½®åˆå¹¶     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                               â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚     createTaskQueue()       â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
                                               â–¼
                                     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                     â”‚ new TaskQueue()  â”‚
                                     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ¯ å…³é”®è°ƒç”¨é“¾è·¯

### ä¸»è¦æ‰§è¡Œè·¯å¾„

1. **åˆå§‹åŒ–**: `constructor` â†’ é…ç½®è®¾ç½® â†’ çŠ¶æ€åˆå§‹åŒ–
2. **æ·»åŠ ä»»åŠ¡**: `addTask` â†’ ä»»åŠ¡åˆ›å»º â†’ æ’åº â†’ `updateProgress`
3. **å¼€å§‹æ‰§è¡Œ**: `start` â†’ `processQueue` â†’ `executeTask` â†’ `handleTaskError`
4. **è°ƒåº¦å¾ªç¯**: `processQueue` â†’ `setTimeout` â†’ `processQueue` (é€’å½’)
5. **çŠ¶æ€ç›‘æ§**: `updateProgress` â†’ `onProgress` â†’ UIæ›´æ–°

### å…³é”®å†³ç­–ç‚¹

| å‡½æ•°                  | å†³ç­–ç‚¹           | å½±å“               |
| --------------------- | ---------------- | ------------------ |
| `processQueue()`    | å¹¶å‘æ§åˆ¶æ£€æŸ¥     | æ˜¯å¦å¯åŠ¨æ–°ä»»åŠ¡     |
| `executeTask()`     | Promise.raceç»“æœ | æˆåŠŸ/è¶…æ—¶/å¤±è´¥è·¯å¾„ |
| `handleTaskError()` | é‡è¯•æ¬¡æ•°åˆ¤æ–­     | é‡è¯•/æœ€ç»ˆå¤±è´¥      |
| `isComplete()`      | é˜Ÿåˆ—çŠ¶æ€æ£€æŸ¥     | æ˜¯å¦ç»“æŸæ‰§è¡Œ       |

### å¼‚æ­¥è°ƒç”¨é“¾

```javascript
// ä¸»è¦çš„å¼‚æ­¥è°ƒç”¨æ¨¡å¼
start() â†’ Promise(checkComplete) â†’ isComplete()
executeTask() â†’ Promise.race([task.fn(), timeout]) â†’ success/error
handleTaskError() â†’ sleep() â†’ retry/fail
processQueue() â†’ setTimeout â†’ processQueue (é€’å½’)
```

### æ§åˆ¶æµ

```javascript
// æ§åˆ¶æ“ä½œçš„è°ƒç”¨æµç¨‹
pause() â†’ è®¾ç½®æš‚åœæ ‡å¿—
resume() â†’ æ¸…é™¤æ ‡å¿— â†’ processQueue()
stop() â†’ è®¾ç½®æ ‡å¿— â†’ å–æ¶ˆæ‰€æœ‰ä»»åŠ¡
destroy() â†’ stop() â†’ clear() â†’ æ¸…ç†èµ„æº
```

## ğŸ“Š å‡½æ•°è°ƒç”¨é¢‘ç‡åˆ†æ

### é«˜é¢‘è°ƒç”¨å‡½æ•°

- `processQueue()` - æ ¸å¿ƒè°ƒåº¦å¾ªç¯ï¼ŒæŒç»­è°ƒç”¨
- `updateProgress()` - æ¯æ¬¡çŠ¶æ€å˜åŒ–éƒ½ä¼šè°ƒç”¨
- `executeTask()` - æ¯ä¸ªä»»åŠ¡æ‰§è¡Œæ—¶è°ƒç”¨

### ä¸­é¢‘è°ƒç”¨å‡½æ•°

- `handleTaskError()` - ä»»åŠ¡å¤±è´¥æ—¶è°ƒç”¨
- `addTask()` - æ·»åŠ ä»»åŠ¡æ—¶è°ƒç”¨
- `isComplete()` - æ£€æŸ¥å®ŒæˆçŠ¶æ€æ—¶è°ƒç”¨

### ä½é¢‘è°ƒç”¨å‡½æ•°

- `start()` - é˜Ÿåˆ—å¯åŠ¨æ—¶è°ƒç”¨ä¸€æ¬¡
- `pause()/resume()/stop()` - ç”¨æˆ·æ§åˆ¶æ“ä½œ
- `destroy()` - é˜Ÿåˆ—é”€æ¯æ—¶è°ƒç”¨ä¸€æ¬¡

## ğŸ” è°ƒç”¨å…³ç³»ç‰¹ç‚¹

### 1. é€’å½’è°ƒç”¨

- `processQueue()` é€šè¿‡ `setTimeout` å®ç°è‡ªé€’å½’è°ƒç”¨
- `checkComplete()` åœ¨ `start()` ä¸­å®ç°è½®è¯¢é€’å½’

### 2. å¼‚æ­¥è°ƒç”¨

- å¤§éƒ¨åˆ†æ ¸å¿ƒå‡½æ•°éƒ½æ˜¯å¼‚æ­¥çš„
- ä½¿ç”¨ Promise å’Œ async/await å¤„ç†å¼‚æ­¥æµç¨‹

### 3. äº‹ä»¶é©±åŠ¨

- é€šè¿‡å›è°ƒå‡½æ•°å®ç°äº‹ä»¶é€šçŸ¥
- çŠ¶æ€å˜åŒ–è§¦å‘ç›¸åº”çš„å›è°ƒå‡½æ•°

### 4. çŠ¶æ€æœºæ¨¡å¼

- ä»»åŠ¡çŠ¶æ€: pending â†’ executing â†’ completed/failed
- é˜Ÿåˆ—çŠ¶æ€: åˆå§‹åŒ– â†’ è¿è¡Œ â†’ æš‚åœ/åœæ­¢ â†’ å®Œæˆ

## ğŸ’¡ ä¼˜åŒ–å»ºè®®

### æ€§èƒ½ä¼˜åŒ–

1. å‡å°‘ `updateProgress()` çš„è°ƒç”¨é¢‘ç‡
2. ä¼˜åŒ–ä»»åŠ¡æ’åºç®—æ³•
3. ä½¿ç”¨å¯¹è±¡æ± å‡å°‘å†…å­˜åˆ†é…

### å¯ç»´æŠ¤æ€§ä¼˜åŒ–

1. åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œå°†ç›‘æ§é€»è¾‘ç‹¬ç«‹
2. å¢åŠ æ›´å¤šçš„é’©å­å‡½æ•°
3. æä¾›æ›´ç»†ç²’åº¦çš„é…ç½®é€‰é¡¹

### æ‰©å±•æ€§ä¼˜åŒ–

1. æ”¯æŒæ’ä»¶æœºåˆ¶
2. æä¾›æ›´å¤šçš„é¢„è®¾é…ç½®
3. æ”¯æŒä»»åŠ¡ä¾èµ–å…³ç³»

---

*æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº†TaskQueueç³»ç»Ÿçš„å‡½æ•°è°ƒç”¨å…³ç³»ï¼Œæœ‰åŠ©äºç†è§£ç³»ç»Ÿæ¶æ„å’Œä¼˜åŒ–ç³»ç»Ÿæ€§èƒ½ã€‚*
