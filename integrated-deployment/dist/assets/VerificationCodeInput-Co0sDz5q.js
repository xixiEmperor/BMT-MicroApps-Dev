import{b3 as P,a as T,b4 as b,u as y,E as k,Y as v,r as w,L as S,l as f,J as g,h as A,P as B,Q as E,M as L,N as M,T as i}from"./index-GmfRbgMx.js";import{_ as U}from"./_plugin-vue_export-helper-DedD7E0N.js";function C(o={}){const{getToken:c=()=>null,refreshToken:h,onTokenExpired:s,tokenHeader:d="Authorization",tokenPrefix:r="Bearer "}=o;return{name:"auth",async onRequest(t){const p=await c();return p&&(t.headers=t.headers??{},t.headers[d]=`${r}${p}`),t},async onError(t){if(t&&t.status===401)try{await(s==null?void 0:s())}catch{}throw t}}}const R=T();let m=!1;b({baseURL:"http://localhost:8080",timeout:1e4,plugins:[C({getToken:()=>localStorage.getItem("token"),onTokenExpired:()=>{if(m)return;m=!0,y().userinfo.token?(k.warning("登录已过期，请重新登录"),y().logout()):k.warning("请先登录");const c=R.currentRoute.value.fullPath;c!=="/login"&&R.push({path:"/login",query:{redirect:c}}),setTimeout(()=>{m=!1},1e3)}})]});const $=o=>v({url:"/api/auth/send-code",method:"post",data:o}),z=o=>v({url:"/api/auth/register",method:"post",data:o}),J=o=>P.post("/api/auth/login",o),Q=o=>v({url:"/api/auth/reset-password",method:"post",data:o}),K={class:"verification-code-input"},N={class:"code-inputs"},j=["onUpdate:modelValue","onInput","onKeydown"],q={__name:"VerificationCodeInput",props:{modelValue:{type:String,default:""},length:{type:Number,default:6}},emits:["update:modelValue"],setup(o,{expose:c,emit:h}){const s=o,d=h,r=w(Array(s.length).fill("")),t=w([]),p=(e,u)=>{e&&(t.value[u]=e)};S(()=>s.modelValue,e=>{e!==r.value.join("")&&(r.value=e.split("").concat(Array(s.length).fill("")).slice(0,s.length))},{immediate:!0}),S(r,e=>{const u=e.join("");d("update:modelValue",u)},{deep:!0});const V=(e,u)=>{const a=u.replace(/\D/g,"");r.value[e]=a,a&&e<s.length-1&&i(()=>{var l;(l=t.value[e+1])==null||l.focus()})},D=(e,u)=>{u.key==="Backspace"&&!r.value[e]&&e>0?i(()=>{var a;(a=t.value[e-1])==null||a.focus()}):u.key==="ArrowLeft"&&e>0?i(()=>{var a;(a=t.value[e-1])==null||a.focus()}):u.key==="ArrowRight"&&e<s.length-1&&i(()=>{var a;(a=t.value[e+1])==null||a.focus()})},I=e=>{e.preventDefault();const a=e.clipboardData.getData("text").replace(/\D/g,"").split("").slice(0,s.length);a.forEach((n,_)=>{_<s.length&&(r.value[_]=n)});const l=Math.min(a.length-1,s.length-1);i(()=>{var n;(n=t.value[l])==null||n.focus()})};return c({focus:()=>{var e;(e=t.value[0])==null||e.focus()},clear:()=>{var e;r.value=Array(s.length).fill(""),(e=t.value[0])==null||e.focus()}}),(e,u)=>(g(),f("div",K,[A("div",N,[(g(!0),f(B,null,E(r.value,(a,l)=>L((g(),f("input",{key:l,"onUpdate:modelValue":n=>r.value[l]=n,ref_for:!0,ref:n=>p(n,l),maxlength:"1",class:"code-digit",onInput:n=>V(l,n.target.value),onKeydown:n=>D(l,n),onPaste:I,type:"text",inputmode:"numeric",pattern:"[0-9]*"},null,40,j)),[[M,r.value[l]]])),128))])]))}},Y=U(q,[["__scopeId","data-v-d1422850"]]);export{Y as V,$ as a,z as b,J as c,Q as d};
