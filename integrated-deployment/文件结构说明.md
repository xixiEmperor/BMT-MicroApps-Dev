# éƒ¨ç½²æ–‡ä»¶ç»“æ„è¯´æ˜

## ğŸ“ å®Œæ•´æ–‡ä»¶ç»“æ„

```
integrated-deployment/
â”œâ”€â”€ README.md                           # ğŸ“– å®Œæ•´éƒ¨ç½²æŒ‡å—
â”œâ”€â”€ docker-compose.yml                  # ğŸ³ Docker Composeä¸»é…ç½®
â”œâ”€â”€ env.example                         # ğŸ”§ ç¯å¢ƒå˜é‡æ¨¡æ¿
â”œâ”€â”€ deploy.sh                          # ğŸš€ ä¸€é”®éƒ¨ç½²è„šæœ¬
â”œâ”€â”€ æ–‡ä»¶ç»“æ„è¯´æ˜.md                     # ğŸ“‹ æœ¬æ–‡ä»¶
â”‚
â”œâ”€â”€ nginx/                              # ğŸŒ Nginxé…ç½®ç›®å½•
â”‚   â”œâ”€â”€ nginx.conf                      # âš™ï¸ Nginxä¸»é…ç½®æ–‡ä»¶
â”‚   â””â”€â”€ conf.d/
â”‚       â”œâ”€â”€ app.conf                    # ğŸ”§ åº”ç”¨é…ç½®ï¼ˆç®€æ´ç‰ˆï¼‰
â”‚       â””â”€â”€ app-detailed.conf           # ğŸ“ åº”ç”¨é…ç½®ï¼ˆè¯¦ç»†æ³¨é‡Šç‰ˆï¼‰
â”‚
â”œâ”€â”€ docs/                               # ğŸ“š å­¦ä¹ æ–‡æ¡£ç›®å½•
â”‚   â”œâ”€â”€ Nginxå­¦ä¹ æ–‡æ¡£.md                # ğŸ“– Nginxå®Œæ•´å­¦ä¹ æŒ‡å—
â”‚   â””â”€â”€ Dockerå­¦ä¹ æ–‡æ¡£.md               # ğŸ“– Dockerå®Œæ•´å­¦ä¹ æŒ‡å—
â”‚
â””â”€â”€ å¾…åˆ›å»ºç›®å½•/
    â”œâ”€â”€ dist/                           # ğŸ¯ å‰ç«¯æ„å»ºäº§ç‰©ç›®å½•
    â”‚   â”œâ”€â”€ index.html                  # Vue.jsä¸»åº”ç”¨
    â”‚   â”œâ”€â”€ admin/                      # Reactç®¡ç†åå°
    â”‚   â””â”€â”€ assets/                     # é™æ€èµ„æº
    â”‚
    â”œâ”€â”€ data/                           # ğŸ’¾ æ•°æ®æŒä¹…åŒ–ç›®å½•
    â”‚   â”œâ”€â”€ postgres/                   # PostgreSQLæ•°æ®
    â”‚   â”œâ”€â”€ redis/                      # Redisæ•°æ®
    â”‚   â””â”€â”€ uploads/                    # ç”¨æˆ·ä¸Šä¼ æ–‡ä»¶
    â”‚
    â”œâ”€â”€ nginx/
    â”‚   â”œâ”€â”€ logs/                       # ğŸ“Š Nginxæ—¥å¿—
    â”‚   â””â”€â”€ ssl/                        # ğŸ”’ SSLè¯ä¹¦ï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
    â”‚
    â””â”€â”€ backups/                        # ğŸ—„ï¸ æ•°æ®å¤‡ä»½ç›®å½•
```

## ğŸ“‹ æ–‡ä»¶è¯´æ˜

### ğŸ”§ æ ¸å¿ƒé…ç½®æ–‡ä»¶

#### `docker-compose.yml`
- **ç”¨é€”**: DockeræœåŠ¡ç¼–æ’é…ç½®
- **åŒ…å«æœåŠ¡**:
  - `nginx`: WebæœåŠ¡å™¨å’Œåå‘ä»£ç†
  - `backend-api`: åç«¯APIæœåŠ¡
  - `websocket-server`: WebSocketå®æ—¶æœåŠ¡
  - `postgres-db`: PostgreSQLæ•°æ®åº“
  - `redis-cache`: Redisç¼“å­˜

#### `env.example` 
- **ç”¨é€”**: ç¯å¢ƒå˜é‡é…ç½®æ¨¡æ¿
- **é‡è¦é…ç½®**:
  - æ•°æ®åº“è¿æ¥ä¿¡æ¯
  - Rediså¯†ç 
  - JWTå¯†é’¥
  - åŸŸåé…ç½®

### ğŸŒ Nginxé…ç½®

#### `nginx/nginx.conf`
- **ç”¨é€”**: Nginxä¸»é…ç½®æ–‡ä»¶
- **åŒ…å«**: å…¨å±€è®¾ç½®ã€äº‹ä»¶é…ç½®ã€HTTPé…ç½®

#### `nginx/conf.d/app.conf`
- **ç”¨é€”**: åº”ç”¨çº§é…ç½®ï¼ˆç”Ÿäº§ä½¿ç”¨ï¼‰
- **åŠŸèƒ½**:
  - å‰åç«¯åˆ†ç¦»è·¯ç”±
  - APIåå‘ä»£ç†
  - WebSocketä»£ç†
  - é™æ€èµ„æºä¼˜åŒ–

#### `nginx/conf.d/app-detailed.conf`
- **ç”¨é€”**: è¯¦ç»†æ³¨é‡Šç‰ˆé…ç½®ï¼ˆå­¦ä¹ å‚è€ƒï¼‰
- **ç‰¹ç‚¹**: æ¯è¡Œé…ç½®éƒ½æœ‰è¯¦ç»†è§£é‡Š

### ğŸ“š å­¦ä¹ æ–‡æ¡£

#### `docs/Nginxå­¦ä¹ æ–‡æ¡£.md`
- **å†…å®¹**: Nginxä»å…¥é—¨åˆ°ç²¾é€š
- **ç« èŠ‚**: åŸºç¡€æ¦‚å¿µã€é…ç½®è¯¦è§£ã€å®æˆ˜æ¡ˆä¾‹
- **é€‚ç”¨**: æ–°æ‰‹å­¦ä¹ å’Œé«˜çº§å‚è€ƒ

#### `docs/Dockerå­¦ä¹ æ–‡æ¡£.md`
- **å†…å®¹**: Dockerå®Œæ•´å­¦ä¹ æŒ‡å—
- **ç« èŠ‚**: å®¹å™¨åŸºç¡€ã€é•œåƒæ„å»ºã€ç¼–æ’éƒ¨ç½²
- **é€‚ç”¨**: å®¹å™¨åŒ–æŠ€æœ¯å­¦ä¹ 

### ğŸš€ éƒ¨ç½²å·¥å…·

#### `deploy.sh`
- **ç”¨é€”**: ä¸€é”®éƒ¨ç½²è„šæœ¬
- **åŠŸèƒ½**:
  - è‡ªåŠ¨æ„å»ºå‰ç«¯
  - åˆ›å»ºå¿…éœ€ç›®å½•
  - å¯åŠ¨DockeræœåŠ¡
  - å¥åº·æ£€æŸ¥

#### `README.md`
- **ç”¨é€”**: å®Œæ•´éƒ¨ç½²æŒ‡å—
- **å†…å®¹**:
  - åˆ†æ­¥æ“ä½œè¯´æ˜
  - æ•…éšœæ’æŸ¥æŒ‡å—
  - å¸¸ç”¨å‘½ä»¤å‚è€ƒ

## ğŸ¯ ä½¿ç”¨æµç¨‹

### ç¬¬ä¸€æ­¥ï¼šå‡†å¤‡å·¥ä½œ
```bash
# 1. å¤åˆ¶éƒ¨ç½²æ–‡ä»¶åˆ°é¡¹ç›®æ ¹ç›®å½•
cp -r integrated-deployment/* ./

# 2. é…ç½®ç¯å¢ƒå˜é‡
cp env.example .env
# ç¼–è¾‘ .env æ–‡ä»¶ï¼Œä¿®æ”¹æ•°æ®åº“å¯†ç ç­‰é…ç½®
```

### ç¬¬äºŒæ­¥ï¼šæ„å»ºå‰ç«¯
```bash
# æ„å»ºVue.jså‰ç«¯
npm run build

# æ„å»ºReactç®¡ç†åå°
cd BadmintonFrontend-B && npm run build && cd ..

# å¤åˆ¶æ„å»ºäº§ç‰©
mkdir -p dist/admin
cp -r dist/* ./dist/
cp -r BadmintonFrontend-B/dist/* ./dist/admin/
```

### ç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨æœåŠ¡
```bash
# ä½¿ç”¨è‡ªåŠ¨éƒ¨ç½²è„šæœ¬ï¼ˆæ¨èï¼‰
chmod +x deploy.sh
./deploy.sh

# æˆ–æ‰‹åŠ¨å¯åŠ¨
docker-compose up -d
```

### ç¬¬å››æ­¥ï¼šéªŒè¯éƒ¨ç½²
```bash
# æ£€æŸ¥æœåŠ¡çŠ¶æ€
docker-compose ps

# æµ‹è¯•è®¿é—®
curl http://localhost          # Vue.jså‰ç«¯
curl http://localhost/admin    # Reactç®¡ç†åå°
curl http://localhost/api/health  # APIå¥åº·æ£€æŸ¥
```

## ğŸ”§ é…ç½®è¯´æ˜

### ç¯å¢ƒå˜é‡é…ç½®
```bash
# å¿…é¡»ä¿®æ”¹çš„é…ç½®
POSTGRES_PASSWORD=your_secure_password     # æ•°æ®åº“å¯†ç 
REDIS_PASSWORD=your_redis_password         # Rediså¯†ç 
JWT_SECRET=your_jwt_secret_32_chars        # JWTå¯†é’¥
PROJECT_DOMAIN=your-domain.com             # åŸŸå

# å¯é€‰é…ç½®
NODE_ENV=production                        # è¿è¡Œç¯å¢ƒ
API_PORT=3000                             # APIç«¯å£
WS_PORT=5000                              # WebSocketç«¯å£
```

### ç«¯å£æ˜ å°„
```bash
# å¯¹å¤–å¼€æ”¾ç«¯å£
80:80       # HTTPæœåŠ¡ï¼ˆNginxï¼‰
443:443     # HTTPSæœåŠ¡ï¼ˆå¦‚æœé…ç½®SSLï¼‰

# å†…éƒ¨ç«¯å£ï¼ˆä»…å®¹å™¨é—´é€šä¿¡ï¼‰
3000        # åç«¯APIæœåŠ¡
5000        # WebSocketæœåŠ¡
5432        # PostgreSQLæ•°æ®åº“
6379        # Redisç¼“å­˜
```

## ğŸ›¡ï¸ å®‰å…¨æ³¨æ„äº‹é¡¹

### ç”Ÿäº§ç¯å¢ƒå¿…åš
1. **ä¿®æ”¹é»˜è®¤å¯†ç **: æ‰€æœ‰æ•°æ®åº“å’ŒæœåŠ¡å¯†ç 
2. **é…ç½®é˜²ç«å¢™**: åªå¼€æ”¾å¿…è¦ç«¯å£
3. **SSLè¯ä¹¦**: é…ç½®HTTPSï¼ˆç”Ÿäº§ç¯å¢ƒï¼‰
4. **å®šæœŸå¤‡ä»½**: æ•°æ®åº“å’Œé‡è¦æ–‡ä»¶
5. **ç›‘æ§æ—¥å¿—**: å…³æ³¨å¼‚å¸¸è®¿é—®

### æ¨èå®‰å…¨é…ç½®
```bash
# ç”Ÿæˆå¼ºå¯†ç 
openssl rand -base64 32

# é…ç½®SSLè¯ä¹¦ï¼ˆLet's Encryptæ¨èï¼‰
certbot --nginx -d your-domain.com

# è®¾ç½®æ–‡ä»¶æƒé™
chmod 600 .env
chmod 700 nginx/ssl/
```

## ğŸ“Š ç›‘æ§å’Œç»´æŠ¤

### å¸¸ç”¨å‘½ä»¤
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f nginx
docker-compose logs -f backend-api

# é‡å¯æœåŠ¡
docker-compose restart nginx

# æ›´æ–°æœåŠ¡
docker-compose pull
docker-compose up -d
```

### æ•°æ®å¤‡ä»½
```bash
# å¤‡ä»½æ•°æ®åº“
docker-compose exec postgres-db pg_dump -U user database > backup.sql

# å¤‡ä»½æ•°æ®å·
docker run --rm -v data_volume:/data -v $(pwd):/backup alpine tar czf /backup/data-backup.tar.gz -C /data .
```

## ğŸ” æ•…éšœæ’æŸ¥

### å¸¸è§é—®é¢˜
1. **ç«¯å£è¢«å ç”¨**: `netstat -tlnp | grep :80`
2. **æƒé™é—®é¢˜**: `sudo chown -R $USER:$USER .`
3. **å®¹å™¨æ— æ³•å¯åŠ¨**: `docker-compose logs [æœåŠ¡å]`
4. **ç½‘ç»œé—®é¢˜**: `docker network ls`

### è°ƒè¯•æŠ€å·§
```bash
# è¿›å…¥å®¹å™¨è°ƒè¯•
docker-compose exec nginx sh
docker-compose exec backend-api bash

# æŸ¥çœ‹å®¹å™¨èµ„æºä½¿ç”¨
docker stats

# æ£€æŸ¥é…ç½®æ–‡ä»¶è¯­æ³•
docker-compose config
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚é‡åˆ°é—®é¢˜ï¼Œè¯·æŒ‰ä»¥ä¸‹é¡ºåºæ’æŸ¥ï¼š
1. æ£€æŸ¥ç¯å¢ƒå˜é‡é…ç½®æ˜¯å¦æ­£ç¡®
2. æŸ¥çœ‹å®¹å™¨æ—¥å¿—å®šä½é”™è¯¯
3. éªŒè¯ç«¯å£æ˜¯å¦è¢«å ç”¨
4. å‚è€ƒå­¦ä¹ æ–‡æ¡£ä¸­çš„æ•…éšœæ’æŸ¥ç« èŠ‚
5. æ£€æŸ¥Dockerå’ŒDocker Composeç‰ˆæœ¬å…¼å®¹æ€§

---

**è¯´æ˜**: æœ¬æ–‡æ¡£é…åˆå…¶ä»–æ–‡ä»¶ä½¿ç”¨ï¼Œç¡®ä¿å®Œæ•´çš„éƒ¨ç½²å’Œå­¦ä¹ ä½“éªŒã€‚
