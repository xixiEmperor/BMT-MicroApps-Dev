# 🚀 BMT项目部署配置清单

## ⚠️ 必须修改的配置信息

### 1. 环境变量配置 (`.env` 文件)

**🔴 必须修改的配置：**
```bash
# 数据库密码 - 改为强密码
POSTGRES_PASSWORD=your_secure_db_password_here
# 建议：至少12位，包含大小写字母、数字、特殊字符

# Redis密码 - 改为强密码  
REDIS_PASSWORD=your_secure_redis_password_here
# 建议：至少12位随机字符串

# JWT密钥 - 改为32位以上随机字符串
JWT_SECRET=your_super_secret_jwt_key_here_min_32_chars
# 建议：使用 openssl rand -base64 32 生成

# 域名配置 - 改为您的实际域名
PROJECT_DOMAIN=your-domain.com
# 如果只是本地测试，可以保持 localhost
```

**🔶 可选修改的配置：**
```bash
# 项目名称（影响容器名称前缀）
COMPOSE_PROJECT_NAME=bmt-microapps

# CORS跨域配置
CORS_ORIGIN=http://localhost,https://your-domain.com

# 邮件服务（如果需要发邮件功能）
SMTP_HOST=smtp.example.com
SMTP_USER=noreply@your-domain.com
SMTP_PASSWORD=your_smtp_password

# 微信/支付宝（如果需要支付功能）
WECHAT_APP_ID=your_wechat_app_id
WECHAT_APP_SECRET=your_wechat_app_secret
ALIPAY_APP_ID=your_alipay_app_id
```

### 2. Nginx域名配置

**文件位置**: `nginx/conf.d/app.conf`

**需要修改的行**:
```nginx
# 第19行：将 your-domain.com 替换为您的实际域名
server_name localhost your-domain.com;
```

如果只是本地测试，保持 `localhost` 即可。

## 🛠️ 快速部署步骤

### 方法一：使用一键部署脚本（推荐）

```bash
# 1. 进入部署目录
cd integrated-deployment

# 2. 创建环境配置文件
copy env.example .env

# 3. 编辑 .env 文件，修改上述必须配置项
notepad .env

# 4. 运行一键部署脚本
quick-deploy.bat
```

### 方法二：手动部署

```bash
# 1. 配置环境变量
copy env.example .env
# 编辑 .env 文件

# 2. 构建前端项目
cd ..
npm run build
cd BadmintonFrontend-B && npm run build && cd ..

# 3. 复制构建产物
mkdir integrated-deployment\dist\admin
xcopy /E /Y dist\* integrated-deployment\dist\
xcopy /E /Y BadmintonFrontend-B\dist\* integrated-deployment\dist\admin\

# 4. 启动服务
cd integrated-deployment
docker-compose up -d
```

## ✅ 部署后验证

部署完成后，访问以下地址验证：

- **前端页面**: http://localhost
- **管理后台**: http://localhost/admin
- **API健康检查**: http://localhost/health
- **服务状态**: `docker-compose ps`

## 🔧 生成强密码的方法

### Windows PowerShell
```powershell
# 生成32位随机密码
[System.Web.Security.Membership]::GeneratePassword(32, 8)

# 或使用这个
-join ((65..90) + (97..122) + (48..57) | Get-Random -Count 32 | % {[char]$_})
```

### 在线生成器
- https://www.random.org/passwords/
- https://passwordsgenerator.net/

### 建议的安全配置
```bash
# 数据库密码示例
POSTGRES_PASSWORD=Bmt2024!@#DbPass789

# Redis密码示例  
REDIS_PASSWORD=Redis!Secure@Pass#2024

# JWT密钥示例
JWT_SECRET=eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9bmV3c2VjcmV0a2V5
```

## 🚨 安全提醒

1. **永远不要**将 `.env` 文件提交到Git仓库
2. **生产环境**必须使用HTTPS和强密码
3. **定期更换**数据库和Redis密码
4. **备份重要数据**到安全的地方

## 🆘 常见问题

### 问题1：Docker启动失败
**解决**：确保Docker Desktop正在运行

### 问题2：端口被占用
**解决**：
```bash
# 查看端口占用
netstat -ano | findstr :80
# 停止占用端口的程序或修改docker-compose.yml中的端口映射
```

### 问题3：前端构建失败
**解决**：
```bash
# 清理node_modules重新安装
rm -rf node_modules
npm install
npm run build
```

### 问题4：权限问题
**解决**：以管理员身份运行命令提示符

---

**完成这些配置后，您就可以成功部署BMT羽毛球场馆管理系统了！** 🎉
